body {
    background: #050505;
    color: #eee;
    text-align: center;
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
    overflow: hidden;
}

canvas {
    background: #050505;
    display: none;
}

.pixel-title {
    font-family: 'Press Start 2P', cursive;
    font-size: 2.5em;
    color: #00ff00;
    text-transform: uppercase;
    margin-bottom: 20px;
    text-shadow: 4px 4px #005500;
}

/* HUD Principal Compacto */
#mainHUD {
    position: absolute;
    top: 20px;
    left: 20px;
    background: rgba(0, 0, 0, 0.85);
    padding: 15px;
    border-left: 4px solid #00ff00;
    border-radius: 0 10px 10px 0;
    display: none;
    flex-direction: column;
    gap: 12px;
    z-index: 100;
    box-shadow: 10px 0 20px rgba(0, 0, 0, 0.5);
    min-width: 220px;
}

.hud-row {
    display: flex;
    flex-direction: column;
    gap: 4px;
    align-items: flex-start;
}

.hud-label {
    font-family: 'Press Start 2P';
    font-size: 8px;
    color: #888;
    text-transform: uppercase;
}

/* Barras */
.bar-container {
    width: 200px;
    height: 12px;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid #333;
    position: relative;
    overflow: hidden;
}

.bar-fill {
    height: 100%;
    transition: width 0.3s ease-out;
}

#hpFill {
    background: linear-gradient(90deg, #ff3333, #ff6666);
}

#staminaArea {
    display: flex;
    flex-direction: column;
    gap: 4px;
    width: 100%;
}

.stamina-container {
    width: 100%;
    height: 6px;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid #333;
    overflow: hidden;
}

.stamina-fill {
    height: 100%;
    background: #ffe600;
}

/* Slots de Cargas (PEM e Stamina) */
.charge-group {
    display: flex;
    gap: 5px;
    margin-top: 2px;
}

.slot {
    width: 18px;
    height: 10px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid #444;
    border-radius: 1px;
    position: relative;
}

.slot::after {
    content: '';
    position: absolute;
    right: -3px;
    top: 2px;
    width: 2px;
    height: 4px;
    background: #444;
}

/* PEM - Azul */
.slot.pem.active {
    background: #9900ff;
    border-color: #fff;
    box-shadow: 0 0 10px rgba(140, 0, 255, 0.5);
}

.slot.pem.active::after {
    background: #fff;
}

/* Stamina - Amarelo */
.slot.stamina.active {
    background: #ffff00;
    border-color: #fff;
    box-shadow: 0 0 10px rgba(255, 255, 0, 0.5);
}

.slot.stamina.active::after {
    background: #fff;
}

/* Stats Flutuantes (Topo Centro) */
#ui {
    position: absolute;
    top: 15px;
    left: 50%;
    transform: translateX(-50%);
    pointer-events: none;
    background: rgba(0, 0, 0, 0.8);
    padding: 8px 20px;
    border-radius: 20px;
    border: 1px solid #444;
    display: none;
    gap: 20px;
    z-index: 10;
}

.stat-box {
    text-align: center;
}

.label {
    font-size: 0.5em;
    text-transform: uppercase;
    color: #888;
    font-family: 'Press Start 2P';
}

.value {
    font-size: 1em;
    color: #00ff00;
    font-weight: bold;
    display: block;
    font-family: 'Press Start 2P';
}

#radarContainer {
    position: absolute;
    bottom: 20px;
    right: 20px;
    width: 150px;
    height: 150px;
    background: rgba(0, 40, 0, 0.5);
    border: 2px solid #00ff00;
    border-radius: 50%;
    overflow: hidden;
    display: none;
    z-index: 10;
    box-shadow: 0 0 15px rgba(0, 255, 0, 0.2);
}

#radarCanvas {
    width: 100%;
    height: 100%;
}

#mainMenu {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(10, 10, 10, 0.98);
    padding: 30px;
    border-radius: 10px;
    border: 4px solid #00ff00;
    z-index: 100;
    min-width: 800px;
    display: flex;
    gap: 40px;
    align-items: flex-start;
}

#menuPoster {
    width: 300px;
    height: 533px;
    background: #111 url('assets/menu_capa.jpg') center/cover no-repeat;
    border: 2px solid #00ff00;
    border-radius: 8px;
    box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
}

.menu-side {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.config-group {
    margin: 15px 0;
    text-align: left;
    font-family: 'Press Start 2P';
    font-size: 10px;
    width: 100%;
}

.config-group label {
    display: block;
    margin-bottom: 12px;
    color: #00ff00;
}

.preview-box {
    width: 100px;
    height: 100px;
    background: #000;
    border: 2px solid #00ff00;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
}

#previewTriangle {
    width: 0;
    height: 0;
    border-left: 25px solid transparent;
    border-right: 25px solid transparent;
    border-bottom: 50px solid #00ff00;
    filter: drop-shadow(0 0 10px #00ff00);
    pointer-events: none;
}

input[type=range] {
    width: 100%;
    accent-color: #00ff00;
    cursor: pointer;
}

.btn {
    background: #00ff00;
    color: #000;
    border: none;
    padding: 20px;
    font-family: 'Press Start 2P';
    font-size: 1.2em;
    cursor: pointer;
    width: 100%;
    margin-top: 10px;
    box-shadow: 4px 4px #005500;
    text-transform: uppercase;
}

.btn:hover {
    background: #fff;
    box-shadow: 4px 4px #888;
}

#interactHint {
    position: absolute;
    bottom: 100px;
    left: 50%;
    transform: translateX(-50%);
    font-family: 'Press Start 2P';
    color: #ffff00;
    font-size: 12px;
    display: none;
    z-index: 20;
}

#evolutionAlert {
    position: absolute;
    top: 120px;
    left: 50%;
    transform: translateX(-50%);
    font-family: 'Press Start 2P';
    color: #ff0000;
    font-size: 16px;
    display: none;
    z-index: 20;
    animation: blink 0.5s infinite;
}

@keyframes blink {
    50% {
        opacity: 0;
    }
}

/* --- EFEITO SLIME METABALL --- */
.mob-slime {
    position: absolute;
    width: 96px; /* Reduzido 20% de 120px */
    height: 96px; /* Reduzido 20% de 120px */
    filter: url(#goo);
    pointer-events: none;
    z-index: 5;
    display: block;
}

.mob-slime .core {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 48% 52% 55% 45% / 48% 44% 56% 52%;
    background:
      radial-gradient(48px 48px at 30% 30%, rgba(255,255,255,.6), transparent 60%),
      radial-gradient(72px 56px at 70% 75%, rgba(0,0,0,.25), transparent 70%),
      linear-gradient(135deg, #43ffb7, #1ad0ff);
    box-shadow:
      0 12px 28px rgba(0,0,0,.4),
      inset 0 10px 16px rgba(255,255,255,.15),
      inset 0 -12px 20px rgba(0,0,0,.2);
    animation: slimeWobble 3s ease-in-out infinite;
}

.mob-slime .drop {
    position: absolute;
    width: 32px; /* Reduzido 20% de 40px */
    height: 32px;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    border-radius: 50%;
    background: linear-gradient(135deg, #43ffb7, #1ad0ff);
    opacity: .85;
    animation: orbit 4s linear infinite;
}

.mob-slime .drop:nth-child(3){
    width: 22px; /* Reduzido 20% de 28px */
    height: 22px;
    animation-duration: 5s;
    animation-direction: reverse;
}

@keyframes slimeWobble {
    0%   { border-radius: 48% 52% 55% 45% / 48% 44% 56% 52%; }
    50%  { border-radius: 55% 45% 48% 52% / 52% 58% 42% 48%; }
    100% { border-radius: 48% 52% 55% 45% / 48% 44% 56% 52%; }
}

@keyframes orbit {
    0%   { transform: translate(-50%, -50%) rotate(0deg) translateX(35px); } 
    100% { transform: translate(-50%, -50%) rotate(360deg) translateX(35px); }
}

    /* --- EFEITO ALIEN (SHIELD EYE) --- */
    .mob-alien {
        position: absolute;
        width: 100px; 
        height: 100px;
        pointer-events: none;
        z-index: 5;
        display: block;
    }

    /* CONTAINER PARA O LASER HTML E EFEITOS (Para ficar acima de tudo) */
    .alien-laser-html {
        position: absolute;
        height: 12px;
        background: rgba(255, 0, 0, 0.9);
        box-shadow: 0 0 25px #ff0000;
        pointer-events: none;
        z-index: 9999;
        transform-origin: left center;
        border-radius: 6px;
        display: none;
    }

    .alien-laser-html::after {
        content: '';
        position: absolute;
        top: 4px;
        left: 0;
        width: 100%;
        height: 4px;
        background: #fff;
        border-radius: 2px;
    }

    /* NOVO: MUZZLE FLASH HTML (Glow no ponto de disparo) */
    .alien-muzzle-html {
        position: absolute;
        width: 40px;
        height: 40px;
        background: radial-gradient(circle, #fff 0%, #ff0000 40%, transparent 70%);
        border-radius: 50%;
        z-index: 10000;
        pointer-events: none;
        display: none;
        transform: translate(-50%, -50%);
        mix-blend-mode: screen;
        animation: alienMuzzlePulse 0.1s infinite alternate;
    }

    @keyframes alienMuzzlePulse {
        from { transform: translate(-50%, -50%) scale(0.8); opacity: 0.8; }
        to { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
    }

.alien-core {
    width: 100%;
    height: 100%;
    position: relative;
    border-radius: 54% 46% 56% 44% / 52% 46% 54% 48%;
    background:
      radial-gradient(45px 40px at 30% 26%, rgba(255,255,255,.28), transparent 62%),
      radial-gradient(65px 60px at 70% 80%, rgba(0,0,0,.24), transparent 72%),
      radial-gradient(35px 27px at 60% 38%, rgba(0,0,0,.14), transparent 70%),
      linear-gradient(145deg, #b46bff 0%, #8a3cff 45%, #6a24e7 100%);
    box-shadow:
      inset 0 9px 15px rgba(255,255,255,.16),
      inset 0 -13px 21px rgba(0,0,0,.32);
    animation: wobble 2.8s ease-in-out infinite;
    overflow: hidden;
}

.alien-eye {
    position: absolute;
    left: 50%;
    top: 45%;
    transform: translate(-50%, -50%);
    width: 50px;
    height: 50px;
}

.eye-glow {
    position: absolute;
    inset: -10px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(255,50,50,.32), rgba(255,50,50,0) 66%);
    animation: alienPulse 1.35s ease-in-out infinite;
    mix-blend-mode: screen;
}

.eye-white {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    position: relative;
    overflow: hidden;
    background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.72), rgba(255,205,205,.40) 52%, rgba(150,0,0,.34) 100%);
    box-shadow: inset 0 7px 11px rgba(255,255,255,.14), inset 0 -9px 12px rgba(0,0,0,.34);
}

.eye-iris {
    position: absolute;
    left: 50%;
    top: 50%;
    width: 20px;
    height: 20px;
    transform: translate(-50%, -50%);
    border-radius: 50%;
    background: radial-gradient(circle at 35% 35%, #ff7070, #ff0000 55%, #6a0000 100%);
    box-shadow: 0 0 11px rgba(255,0,0,.55);
}

.eye-iris::after {
    content: "";
    position: absolute;
    left: 50%;
    top: 50%;
    width: 7px;
    height: 7px;
    transform: translate(-50%, -50%);
    border-radius: 50%;
    background: #000;
}

.eye-lid {
    position: absolute;
    inset: 0;
    border-radius: 50%;
    background: #6a24e7;
    transform: scaleY(0);
    animation: blink 3.6s infinite;
    opacity: .95;
}

.alien-mouth {
    position: absolute;
    left: 50%;
    top: 78%;
    transform: translate(-50%, -50%) rotate(-2deg);
    width: 40px;
    height: 13px;
    border-radius: 0 0 22px 22px;
    background: rgba(0,0,0,.55);
    overflow: hidden;
}

.alien-mouth::before, .alien-mouth::after {
    content: "";
    position: absolute;
    left: -4px;
    right: -4px;
    height: 60%;
    background: repeating-linear-gradient(90deg, rgba(255,235,235,.75) 0px, rgba(255,235,235,.75) 3px, rgba(0,0,0,0) 4px, rgba(0,0,0,0) 7px);
    opacity: .55;
}

.alien-mouth::before { top: -1px; clip-path: polygon(0% 65%, 6% 15%, 12% 65%, 18% 15%, 24% 65%, 30% 15%, 36% 65%, 42% 15%, 48% 65%, 54% 15%, 60% 65%, 66% 15%, 72% 65%, 78% 15%, 84% 65%, 90% 15%, 96% 65%, 100% 15%, 100% 0%, 0% 0%); }
.alien-mouth::after { bottom: -1px; clip-path: polygon(0% 35%, 6% 85%, 12% 35%, 18% 85%, 24% 35%, 30% 85%, 36% 35%, 42% 85%, 48% 35%, 54% 85%, 60% 35%, 66% 85%, 72% 35%, 78% 85%, 84% 35%, 90% 85%, 96% 35%, 100% 85%, 100% 100%, 0% 100%); }

@keyframes alienPulse {
    0%, 100% { transform: scale(1); opacity: .78; }
    50% { transform: scale(1.12); opacity: 1; }
}

/* --- EFEITO PEM CINEMÁTICO (EMP PULSE) --- */
.emp-container {
    position: absolute;
    left: 0; top: 0;
    width: 0; height: 0;
    pointer-events: none;
    z-index: 10002; /* Acima de quase tudo */
}

.ring {
    position: absolute;
    left: 0; top: 0;
    width: 0; height: 0;
    transform: translate(-50%,-50%);
    border-radius: 50%;
    opacity: 0;
    will-change: width, height, opacity;
}

.ring::before {
    content: "";
    position: absolute;
    inset: -10px;
    border-radius: 50%;
    background:
      radial-gradient(circle, rgba(0,0,0,0) 58%, rgba(255,255,255,.55) 60%, rgba(150,110,255,.35) 62%, rgba(0,0,0,0) 66%),
      radial-gradient(circle, rgba(0,0,0,0) 70%, rgba(111,230,255,.22) 72%, rgba(0,0,0,0) 76%);
    filter: blur(0.3px);
    mix-blend-mode: screen;
}

.ring::after {
    content: "";
    position: absolute;
    inset: -18px;
    border-radius: 50%;
    background: conic-gradient(from 0deg, rgba(255,255,255,0) 0deg, rgba(255,255,255,.18) 18deg, rgba(255,255,255,0) 32deg, rgba(255,255,255,.14) 70deg, rgba(255,255,255,0) 92deg, rgba(255,255,255,.12) 140deg, rgba(255,255,255,0) 165deg, rgba(255,255,255,.16) 210deg, rgba(255,255,255,0) 240deg, rgba(255,255,255,.10) 290deg, rgba(255,255,255,0) 360deg);
    -webkit-mask: radial-gradient(circle, rgba(0,0,0,0) 63%, rgba(0,0,0,1) 66%, rgba(0,0,0,1) 69%, rgba(0,0,0,0) 73%);
    mask: radial-gradient(circle, rgba(0,0,0,0) 63%, rgba(0,0,0,1) 66%, rgba(0,0,0,1) 69%, rgba(0,0,0,0) 73%);
    filter: blur(1.1px);
    mix-blend-mode: screen;
}

@keyframes expandFadePEM {
    0%   { width:0px; height:0px; opacity:0; transform:translate(-50%,-50%) scale(0.98); }
    8%   { opacity:1; }
    100% { width:1200px; height:1200px; opacity:0; transform:translate(-50%,-50%) scale(1.02); }
}

.ring.r1 { animation: expandFadePEM 900ms ease-out forwards; }
.ring.r2 { animation: expandFadePEM 1050ms ease-out forwards; animation-delay: 120ms; filter: blur(0.6px); }

/* Inventário de Debug */
#inventory {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(10, 10, 10, 0.95);
    padding: 30px;
    border: 3px solid #00ff00;
    border-radius: 10px;
    z-index: 1000;
    display: none;
    min-width: 400px;
    box-shadow: 0 0 30px rgba(0, 255, 0, 0.2);
}

.inv-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
}

.inv-item {
    background: #222;
    border: 2px solid #444;
    padding: 15px;
    cursor: pointer;
    font-family: 'Press Start 2P';
    font-size: 10px;
    color: #fff;
    display: flex;
    align-items: center;
    gap: 10px;
}

.inv-item:hover {
    background: #333;
    border-color: #00ff00;
}

.inv-icon {
    width: 20px;
    height: 20px;
    border-radius: 3px;
}

/* --- MOBILE CONTROLS --- */
#mobileControls {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 1000;
}

.joystick-base {
    position: absolute;
    bottom: 50px;
    width: 120px;
    height: 120px;
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(0, 255, 0, 0.3);
    border-radius: 50%;
    pointer-events: auto;
    touch-action: none;
}

#joystickMove { left: 40px; }
#joystickShoot { right: 40px; }

.joystick-stick {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 50px;
    height: 50px;
    background: rgba(0, 255, 0, 0.5);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    box-shadow: 0 0 15px rgba(0, 255, 0, 0.4);
}

#mobileButtons {
    position: absolute;
    bottom: 180px;
    right: 40px;
    display: flex;
    flex-direction: column;
    gap: 15px;
    pointer-events: auto;
}

.mobile-action-btn {
    width: 60px;
    height: 60px;
    background: rgba(10, 10, 10, 0.8);
    border: 2px solid #00ff00;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #00ff00;
    font-family: 'Press Start 2P';
    font-size: 10px;
    box-shadow: 0 0 10px rgba(0, 255, 0, 0.2);
}

/* Responsividade de HUD para Mobile */
@media (max-width: 768px) {
    #mainHUD {
        transform: scale(0.7);
        top: 10px;
        left: 10px;
    }
    #ui {
        transform: translateX(-50%) scale(0.8);
        top: 5px;
        gap: 10px;
    }
    #radarContainer {
        display: none !important; /* Radar ocupa muito espaço no mobile */
    }
    #mainMenu {
        min-width: 90%;
        flex-direction: column;
        padding: 15px;
        gap: 15px;
        overflow-y: auto;
        height: 90%;
    }
    #menuPoster {
        width: 100%;
        height: 150px;
    }
    .pixel-title {
        font-size: 1.2em;
    }
}

/* --- AMMO PACK (HTML RENDER) --- */
.mob-ammo {
    position: absolute;
    width: 100px;
    height: 100px;
    pointer-events: none;
    z-index: 5;
}

.mob-ammo .ammo-pack {
    position: relative;
    width: 100%;
    height: 100%;
    transform: scale(0.35); /* Ajuste para o tamanho do jogo */
}

.mob-ammo .bullet {
    position: absolute;
    left: 50%;
    top: 50%;
    width: 14px;
    height: 38px;
    border-radius: 999px;
    transform: translate(-50%,-50%);
    background:
      radial-gradient(10px 18px at 35% 25%, rgba(255,255,255,.65), rgba(255,255,255,0) 60%),
      linear-gradient(90deg, rgba(255,255,255,.10), rgba(0,0,0,.30) 55%, rgba(255,255,255,.12)),
      linear-gradient(180deg, rgba(255,215,120,.95), rgba(170,110,30,.95));
    box-shadow:
      inset 0 6px 10px rgba(255,255,255,.18),
      inset 0 -10px 14px rgba(0,0,0,.35);
    opacity: .95;
    animation: ammoFloatBob var(--bob) ease-in-out infinite, ammoSpin var(--spin) linear infinite;
}

.mob-ammo .bullet::before {
    content: "";
    position: absolute;
    left: 50%; top: -6px;
    width: 12px; height: 14px;
    transform: translateX(-50%);
    border-radius: 999px 999px 8px 8px;
    background:
      radial-gradient(10px 10px at 35% 35%, rgba(255,255,255,.55), rgba(255,255,255,0) 65%),
      linear-gradient(180deg, rgba(255,235,170,.95), rgba(170,110,30,.92));
}

.mob-ammo .bullet::after {
    content: "";
    position: absolute;
    left: 50%; bottom: -2px;
    width: 12px; height: 8px;
    transform: translateX(-50%);
    border-radius: 0 0 8px 8px;
    background: linear-gradient(180deg, rgba(60,60,70,.95), rgba(10,10,14,.95));
    opacity: .9;
}

@keyframes ammoFloatBob {
    0%, 100% { transform: translate(calc(-50% + var(--x)), calc(-50% + var(--y))) rotate(var(--r)) translateY(0); }
    50% { transform: translate(calc(-50% + var(--x)), calc(-50% + var(--y))) rotate(var(--r)) translateY(-8px); }
}

@keyframes ammoSpin {
    0% { transform: translate(calc(-50% + var(--x)), calc(-50% + var(--y))) rotate(var(--r)); }
    100% { transform: translate(calc(-50% + var(--x)), calc(-50% + var(--y))) rotate(calc(var(--r) + 360deg)); }
}